<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Dashboard | Agency PM</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
    }
    @keyframes glow {
      0%, 100% {
        box-shadow: 0 0 5px rgba(99, 102, 241, 0.3);
      }
      50% {
        box-shadow: 0 0 20px rgba(99, 102, 241, 0.6);
      }
    }
    .slide-in-left {
      animation: slideInLeft 0.6s ease-out;
    }
    .fade-in-up {
      animation: fadeInUp 0.6s ease-out;
    }
    .pulse-animation {
      animation: pulse 2s infinite;
    }
    .glow-animation {
      animation: glow 2s infinite;
    }
    .glass-card {
      background: rgba(255,255,255,0.9);
      box-shadow: 0 8px 32px rgba(60,40,120,0.15), 0 1.5px 6px rgba(0,0,0,0.08);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .glass-card:hover {
      box-shadow: 0 20px 60px rgba(60,40,120,0.25), 0 5px 15px rgba(0,0,0,0.12);
      transform: translateY(-8px) scale(1.02);
      background: rgba(255,255,255,0.95);
    }
    .sidebar-active {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(168, 85, 247, 0.1));
      color: #6366f1;
      font-weight: 600;
      border-left: 4px solid #6366f1;
      padding-left: 16px;
      margin-left: -16px;
    }
    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      border-radius: 12px;
      transition: all 0.3s ease;
      cursor: pointer;
      margin: 4px 0;
    }
    .nav-item:hover {
      background: rgba(99, 102, 241, 0.08);
      transform: translateX(4px);
    }
    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      margin-bottom: 12px;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 via-white to-purple-100 min-h-screen flex">
  <!-- Sidebar -->
  <aside class="hidden md:flex flex-col min-h-screen w-72 bg-white/95 backdrop-blur-lg shadow-2xl border-r border-white/20 slide-in-left">
    <!-- Logo Section -->
    <div class="p-8 border-b border-gray-100">
      <div class="flex items-center gap-4">
        <div class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center glow-animation">
          <i class="fas fa-rocket text-white text-xl"></i>
        </div>
        <div>
          <h1 class="text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Agency PM</h1>
          <p class="text-sm text-gray-500">My Workspace</p>
        </div>
      </div>
    </div>
    
    <!-- Navigation -->
    <nav class="flex-1 p-6">
      <div class="space-y-2">
        <a href="#" class="nav-item sidebar-active" id="navDashboard">
          <i class="fas fa-home w-5"></i>
          <span>Dashboard</span>
        </a>
        <a href="#" class="nav-item" id="navTasks">
          <i class="fas fa-tasks w-5"></i>
          <span>My Tasks</span>
        </a>
        <a href="#" class="nav-item" id="navProgress">
          <i class="fas fa-chart-bar w-5"></i>
          <span>Progress</span>
        </a>
        <a href="#" class="nav-item" id="navProjects">
          <i class="fas fa-project-diagram w-5"></i>
          <span>Projects</span>
        </a>
      </div>
    </nav>
    
    <!-- User Profile Section -->
    <div class="p-6 border-t border-gray-100">
      <div class="flex items-center gap-3 p-3 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl">
        <div class="w-10 h-10 bg-gradient-to-br from-indigo-400 to-purple-500 rounded-full flex items-center justify-center">
          <i class="fas fa-user text-white text-sm"></i>
        </div>
        <div class="flex-1 min-w-0">
          <p class="text-sm font-medium text-gray-900 truncate" id="sidebarUserEmail">Loading...</p>
          <p class="text-xs text-gray-500" id="sidebarUserRole">Member</p>
        </div>
      </div>
    </div>
  </aside>
  
  <!-- Main Content -->
  <div class="flex-1 flex flex-col min-h-screen fade-in-up">
    <!-- Topbar -->
    <header class="flex justify-between items-center px-8 py-6 bg-white/90 backdrop-blur-lg shadow-lg border-b border-white/20">
      <div class="flex items-center gap-4">
        <div class="hidden md:block">
          <h2 class="text-2xl font-bold text-gray-800" id="welcome">Loading...</h2>
          <p class="text-sm text-gray-500">Have a productive day!</p>
        </div>
      </div>
      <div class="flex items-center gap-4">
        <div class="hidden sm:flex items-center gap-2 px-4 py-2 bg-green-50 border border-green-200 rounded-xl">
          <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
          <span class="text-sm font-medium text-green-700">Online</span>
        </div>
        <button id="logoutBtn"
          class="flex items-center gap-2 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-semibold rounded-xl px-6 py-3 shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-200">
          <i class="fas fa-sign-out-alt"></i>
          <span>Logout</span>
        </button>
      </div>
    </header>
    
    <main class="flex-1 px-6 py-8 md:px-16 space-y-8">
      <!-- Dashboard Section -->
      <div id="dashboardSection">
        <!-- Welcome Banner -->
        <div class="glass-card rounded-2xl p-8 mb-8 bg-gradient-to-r from-indigo-500/10 to-purple-500/10 border border-indigo-200/30">
          <div class="flex items-center justify-between">
            <div>
              <h3 class="text-2xl font-bold text-gray-800 mb-2">Welcome to your workspace!</h3>
              <p class="text-gray-600">Track your tasks, monitor your progress, and stay productive.</p>
            </div>
            <div class="hidden md:flex items-center justify-center w-16 h-16 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl">
              <i class="fas fa-user-check text-white text-2xl"></i>
            </div>
          </div>
        </div>

        <!-- My Stats Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
          <div class="glass-card rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
            <div class="flex items-center justify-between mb-4">
              <div class="stat-icon bg-gradient-to-br from-green-500 to-green-600 text-white">
                <i class="fas fa-check-circle"></i>
              </div>
              <span class="text-xs font-medium text-green-600 bg-green-50 px-2 py-1 rounded-full">Completed</span>
            </div>
            <div class="text-3xl font-extrabold text-gray-800 mb-1" id="completedTasksCount">0</div>
            <div class="text-sm font-medium text-gray-600">Completed Tasks</div>
            <div class="flex items-center mt-2 text-xs text-green-600">
              <i class="fas fa-trophy mr-1"></i>
              <span>Great work!</span>
            </div>
          </div>

          <div class="glass-card rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
            <div class="flex items-center justify-between mb-4">
              <div class="stat-icon bg-gradient-to-br from-yellow-500 to-yellow-600 text-white">
                <i class="fas fa-clock"></i>
              </div>
              <span class="text-xs font-medium text-yellow-600 bg-yellow-50 px-2 py-1 rounded-full">Pending</span>
            </div>
            <div class="text-3xl font-extrabold text-gray-800 mb-1" id="pendingTasksCount">0</div>
            <div class="text-sm font-medium text-gray-600">Pending Tasks</div>
            <div class="flex items-center mt-2 text-xs text-blue-600">
              <i class="fas fa-arrow-right mr-1"></i>
              <span>Keep going!</span>
            </div>
          </div>

          <div class="glass-card rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
            <div class="flex items-center justify-between mb-4">
              <div class="stat-icon bg-gradient-to-br from-red-500 to-red-600 text-white">
                <i class="fas fa-exclamation-triangle"></i>
              </div>
              <span class="text-xs font-medium text-red-600 bg-red-50 px-2 py-1 rounded-full">Overdue</span>
            </div>
            <div class="text-3xl font-extrabold text-gray-800 mb-1" id="overdueTasksCount">0</div>
            <div class="text-sm font-medium text-gray-600">Overdue Tasks</div>
            <div class="flex items-center mt-2 text-xs text-red-600">
              <i class="fas fa-exclamation mr-1"></i>
              <span>Needs attention</span>
            </div>
          </div>

          <div class="glass-card rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
            <div class="flex items-center justify-between mb-4">
              <div class="stat-icon bg-gradient-to-br from-teal-500 to-teal-600 text-white">
                <i class="fas fa-stopwatch"></i>
              </div>
              <span class="text-xs font-medium text-teal-600 bg-teal-50 px-2 py-1 rounded-full">Time</span>
            </div>
            <div class="text-3xl font-extrabold text-gray-800 mb-1" id="totalTimeWorked">00:00:00</div>
            <div class="text-sm font-medium text-gray-600">Time Worked Today</div>
            <div class="flex items-center mt-2 text-xs text-teal-600">
              <i class="fas fa-clock mr-1"></i>
              <span>Today</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Tasks Section -->
      <section id="tasksSection" style="display:none;" class="space-y-6">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8">
          <div>
            <h2 class="text-3xl font-bold text-gray-800 mb-2">
              <i class="fas fa-tasks text-purple-600 mr-3"></i>
              My Tasks
            </h2>
            <p class="text-gray-600">View and manage tasks assigned to you</p>
          </div>
        </div>
        <div id="tasksList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
      </section>

      <!-- Progress Section -->
      <section id="progressSection" style="display:none;" class="space-y-6">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8">
          <div>
            <h2 class="text-3xl font-bold text-gray-800 mb-2">
              <i class="fas fa-chart-bar text-teal-600 mr-3"></i>
              My Progress
            </h2>
            <p class="text-gray-600">Track your productivity and time worked</p>
          </div>
        </div>
        
        <!-- Date Range Selector -->
        <div class="glass-card rounded-2xl p-6 mb-8">
          <h3 class="text-lg font-bold text-gray-800 mb-4">Select Time Range</h3>
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
            <button class="px-4 py-2 bg-indigo-100 text-indigo-700 rounded-xl hover:bg-indigo-200 transition-colors" onclick="setDateRange('today')">Today</button>
            <button class="px-4 py-2 bg-indigo-100 text-indigo-700 rounded-xl hover:bg-indigo-200 transition-colors" onclick="setDateRange('week')">This Week</button>
            <button class="px-4 py-2 bg-indigo-100 text-indigo-700 rounded-xl hover:bg-indigo-200 transition-colors" onclick="setDateRange('month')">This Month</button>
            <button class="px-4 py-2 bg-indigo-100 text-indigo-700 rounded-xl hover:bg-indigo-200 transition-colors" onclick="toggleCustomRange()">Custom Range</button>
          </div>
          
          <div id="customDateRange" class="hidden grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">From Date</label>
              <input type="date" id="fromDate" class="w-full px-3 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-300">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">To Date</label>
              <input type="date" id="toDate" class="w-full px-3 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-300">
            </div>
            <button class="col-span-1 md:col-span-2 px-4 py-2 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 transition-colors" onclick="applyCustomRange()">Apply Range</button>
          </div>
        </div>

        <!-- Progress Stats -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
          <div class="glass-card rounded-2xl p-6">
            <div class="stat-icon bg-gradient-to-br from-blue-500 to-blue-600 text-white">
              <i class="fas fa-clock"></i>
            </div>
            <div class="text-2xl font-bold text-gray-800 mb-1" id="progressTotalTime">00:00:00</div>
            <div class="text-sm text-gray-600">Total Time Worked</div>
          </div>
          
          <div class="glass-card rounded-2xl p-6">
            <div class="stat-icon bg-gradient-to-br from-purple-500 to-purple-600 text-white">
              <i class="fas fa-tasks"></i>
            </div>
            <div class="text-2xl font-bold text-gray-800 mb-1" id="progressTasksCompleted">0</div>
            <div class="text-sm text-gray-600">Tasks Completed</div>
          </div>
          
          <div class="glass-card rounded-2xl p-6">
            <div class="stat-icon bg-gradient-to-br from-green-500 to-green-600 text-white">
              <i class="fas fa-calendar-day"></i>
            </div>
            <div class="text-2xl font-bold text-gray-800 mb-1" id="progressWorkingDays">0</div>
            <div class="text-sm text-gray-600">Working Days</div>
          </div>
          
          <div class="glass-card rounded-2xl p-6">
            <div class="stat-icon bg-gradient-to-br from-orange-500 to-orange-600 text-white">
              <i class="fas fa-tachometer-alt"></i>
            </div>
            <div class="text-2xl font-bold text-gray-800 mb-1" id="progressAvgDaily">00:00:00</div>
            <div class="text-sm text-gray-600">Avg Daily Time</div>
          </div>
        </div>

        <!-- Daily Breakdown -->
        <div class="glass-card rounded-2xl p-6">
          <h3 class="text-lg font-bold text-gray-800 mb-6">Daily Breakdown</h3>
          <div id="dailyBreakdown" class="space-y-4">
            <!-- Daily progress data will be populated here -->
          </div>
        </div>
      </section>

      <!-- Projects Section -->
      <section id="projectsSection" style="display:none;" class="space-y-6">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8">
          <div>
            <h2 class="text-3xl font-bold text-gray-800 mb-2">
              <i class="fas fa-project-diagram text-indigo-600 mr-3"></i>
              My Projects
            </h2>
            <p class="text-gray-600">Projects you're involved in</p>
          </div>
        </div>
        <div id="projectsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
      </section>
    </main>
  </div>
  
  <!-- Timer Modal -->
  <div id="timerModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm hidden">
    <div class="bg-white/95 backdrop-blur-lg rounded-2xl shadow-2xl w-full max-w-md p-8 m-4 border border-white/20 text-center transform transition-all duration-300">
      <div class="mb-6">
        <div class="w-16 h-16 bg-gradient-to-br from-teal-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
          <i class="fas fa-play text-white text-2xl"></i>
        </div>
        <h3 class="text-xl font-bold text-gray-800 mb-2">Task Timer</h3>
        <p id="timerTaskTitle" class="text-gray-600 text-sm">Task name will appear here</p>
      </div>
      
      <div class="mb-8">
        <div id="timerDisplay" class="text-4xl font-mono font-bold text-teal-600 mb-4">00:00:00</div>
      </div>
      
      <div class="flex flex-col gap-4">
        <button id="startTimerBtn" class="w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-200 transform hover:scale-[1.02]">
          <i class="fas fa-play mr-2"></i>Start Timer
        </button>
        
        <button id="stopTimerBtn" class="w-full bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-200 transform hover:scale-[1.02] hidden">
          <i class="fas fa-stop mr-2"></i>Stop Timer
        </button>
        
        <div id="statusControls" class="flex gap-2 hidden">
          <button onclick="updateTaskStatus('pending')" class="flex-1 bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm transition-all">
            Pending
          </button>
          <button onclick="updateTaskStatus('completed')" class="flex-1 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm transition-all">
            Complete
          </button>
        </div>
        
        <button id="closeTimerModal" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 px-6 py-3 rounded-xl font-semibold transition-all duration-200">
          Close
        </button>
      </div>
    </div>
  </div>
  
  <!-- Scripts -->
  <script src="js/firebase.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/member_dashboard.js"></script>
  <script src="js/timer.js"></script>
</body>
</html>